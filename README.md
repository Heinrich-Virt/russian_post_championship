# Всероссийский чемпионат. Почта России.

## Описание
Решение задачи на всероссийском чемпионате для Почты России по прогнозированию утери отправлений. Были предоставлены несколько датасетов. Тренеровочный на 6 млн строк и тестовый на 4 млн строк.

В качестве метрики выступает комбинация двух значений. Результирующее значение выглядит как:

**0.1 * Recall + 0.9 * AUC**

## Инструменты
В данной работе были использованы:
- CatBoost
- Sklearn
- Pandas

В процессе выполнения были опробованы и иные модели: LightGBM, XGBoost, TabNet и другие нейронные сети. Самым эффективным с минимальным отрывом (0.0001, что больше похоже на погрешность) была нейросеть TabNet. Было принято решение использовать более простую модель, результаты которой лучше интерпритируются (это важно для бизнеса) и требуют меньших ресурсов. 

## Проблемы и решение
- Первая проблема заключалась в том, что у нас критически мало данных об утерянных посылках. Из всего датасета лишь 3% содержали информацию о потере отправления.
Для решения данной проблемы я сначала применил алгоритм SMOTE, но он не дал результаты, которые меня удовлетворили бы. Было решено применить обычное копирование признаков. Теперь 40% всех данных относились к отправлениям, которые были потеряны.

- Вторая проблема, которая вызвала у меня замешательство, это множество лишней информации, которая никак не поясняется. "Код отправления", "Тип и атрибут операции" и тд. Когда я работаю с данными, то привык понимать, что означает каждая кодировка. Зная смысл каждой кодировки я могу более эффективно выдвигать гипотезы и искать инсайты, закономерности. Но в данном случае, я работал в слепую, что не помешало получить хороший результат.

- Третья проблема. Огромное количество категориальных данных. Я не очень люблю данный тип, особенно в таком количестве, поэтому пришлось найти способы отображения этой информации в более понятном для меня и модели виде. Я пересчитал каждую метку, что бы она отображала процент потерь по каждой категории. Подобное отображение стало более наглядно для меня и дало не большой прирост к метрике.

- Четвертая. Последняя проблема является классической. Признаков оказалось не достаточно и мне пришлось создавать новую информацию на основе старой (частично это относится и к третьей проблеме). Это сработало. В моей конечной модели одним из самых важных признаков является именно созданный мной.
